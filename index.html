<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Millennium Falcon — SPARC Galaxies & LoCuSS Clusters (Browser Tool)</title>

  <!-- Sci-fi font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700;800&display=swap" rel="stylesheet">

  <!-- Plotly + JSZip -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

  <style>
    :root{
      --bg0:#02030a; --bg1:#070a16;
      --card:rgba(255,255,255,.075);
      --stroke:rgba(255,255,255,.18);
      --text:rgba(240,246,255,.92);
      --muted:rgba(240,246,255,.68);
      --muted2:rgba(240,246,255,.52);
      --ok:#27f2c3; --bad:#ff5470;
      --glow:rgba(120,210,255,.45);
      --glow2:rgba(200,120,255,.30);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:
        radial-gradient(1200px 800px at 18% 12%, rgba(90,190,255,.18), transparent 60%),
        radial-gradient(900px 700px at 84% 16%, rgba(210,110,255,.13), transparent 62%),
        radial-gradient(900px 700px at 55% 92%, rgba(100,255,220,.08), transparent 60%),
        linear-gradient(180deg,var(--bg0),var(--bg1));
      overflow-x:hidden;
    }

    /* Space background: galaxies + cluster halos + ship trail (inline SVG) */
    .space{
      position:fixed; inset:0; pointer-events:none;
      opacity:.56;
      background-image:url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='1600' height='1000' viewBox='0 0 1600 1000'>\
<defs>\
<radialGradient id='galA' cx='50%' cy='50%' r='55%'>\
<stop offset='0' stop-color='%23ffffff' stop-opacity='0.24'/>\
<stop offset='40%' stop-color='%237ad2ff' stop-opacity='0.14'/>\
<stop offset='100%' stop-color='%23000000' stop-opacity='0'/>\
</radialGradient>\
<radialGradient id='galB' cx='50%' cy='50%' r='55%'>\
<stop offset='0' stop-color='%23ffffff' stop-opacity='0.20'/>\
<stop offset='38%' stop-color='%23c878ff' stop-opacity='0.12'/>\
<stop offset='100%' stop-color='%23000000' stop-opacity='0'/>\
</radialGradient>\
<radialGradient id='halo' cx='50%' cy='50%' r='60%'>\
<stop offset='0' stop-color='%23ffffff' stop-opacity='0.08'/>\
<stop offset='55%' stop-color='%23ffffff' stop-opacity='0.02'/>\
<stop offset='100%' stop-color='%23000000' stop-opacity='0'/>\
</radialGradient>\
<linearGradient id='trail' x1='0' y1='0' x2='1' y2='0'>\
<stop offset='0' stop-color='%237ad2ff' stop-opacity='0'/>\
<stop offset='55%' stop-color='%237ad2ff' stop-opacity='0.22'/>\
<stop offset='100%' stop-color='%23c878ff' stop-opacity='0.12'/>\
</linearGradient>\
<filter id='blur8'><feGaussianBlur stdDeviation='8'/></filter>\
<filter id='blur14'><feGaussianBlur stdDeviation='14'/></filter>\
</defs>\
<rect width='1600' height='1000' fill='transparent'/>\
<g fill='%23ffffff' opacity='0.24'>\
<circle cx='71' cy='73' r='1.2'/> <circle cx='183' cy='109' r='0.9'/> <circle cx='265' cy='52' r='0.8'/> <circle cx='338' cy='146' r='1.0'/>\
<circle cx='418' cy='88' r='1.1'/> <circle cx='512' cy='132' r='0.7'/> <circle cx='603' cy='70' r='0.9'/> <circle cx='690' cy='156' r='0.8'/>\
<circle cx='781' cy='92' r='1.0'/> <circle cx='862' cy='61' r='0.7'/> <circle cx='955' cy='141' r='1.2'/> <circle cx='1040' cy='87' r='0.8'/>\
<circle cx='1141' cy='52' r='0.9'/> <circle cx='1248' cy='118' r='1.1'/> <circle cx='1362' cy='71' r='0.7'/> <circle cx='1501' cy='129' r='1.0'/>\
<circle cx='110' cy='310' r='0.8'/> <circle cx='240' cy='280' r='1.1'/> <circle cx='355' cy='330' r='0.7'/> <circle cx='505' cy='290' r='0.9'/>\
<circle cx='640' cy='320' r='1.2'/> <circle cx='790' cy='275' r='0.8'/> <circle cx='910' cy='338' r='0.9'/> <circle cx='1060' cy='300' r='1.1'/>\
<circle cx='1210' cy='332' r='0.7'/> <circle cx='1360' cy='290' r='1.0'/> <circle cx='1500' cy='320' r='0.8'/>\
<circle cx='95' cy='720' r='0.9'/> <circle cx='210' cy='690' r='0.8'/> <circle cx='330' cy='770' r='1.1'/> <circle cx='470' cy='705' r='0.7'/>\
<circle cx='610' cy='780' r='1.2'/> <circle cx='760' cy='700' r='0.8'/> <circle cx='910' cy='760' r='1.0'/> <circle cx='1060' cy='710' r='0.9'/>\
<circle cx='1210' cy='790' r='0.8'/> <circle cx='1370' cy='720' r='1.1'/> <circle cx='1510' cy='780' r='0.7'/>\
</g>\
<g filter='url(%23blur14)' opacity='0.98'>\
<ellipse cx='280' cy='210' rx='250' ry='150' fill='url(%23galA)'/>\
<ellipse cx='1220' cy='240' rx='300' ry='170' fill='url(%23galB)'/>\
<ellipse cx='820' cy='780' rx='360' ry='200' fill='url(%23galA)'/>\
</g>\
<g filter='url(%23blur8)' opacity='0.98'>\
<circle cx='520' cy='520' r='240' fill='url(%23halo)'/>\
<circle cx='1040' cy='560' r='280' fill='url(%23halo)'/>\
</g>\
<path d='M 80 880 C 420 650, 760 640, 1120 380 C 1300 250, 1450 220, 1560 180' stroke='url(%23trail)' stroke-width='10' fill='none' opacity='0.58'/>\
<path d='M 120 900 C 460 680, 780 660, 1150 410 C 1320 280, 1470 240, 1580 190' stroke='url(%23trail)' stroke-width='4' fill='none' opacity='0.48'/>\
</svg>");
      background-size:cover;
      background-position:center;
      mix-blend-mode:screen;
      filter:saturate(1.30) contrast(1.12);
    }

    .wrap{max-width:1320px;margin:0 auto;padding:28px 16px 74px; position:relative}
    .top{display:flex;align-items:flex-end;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:14px}
    h1{
      margin:0;
      font-family:'Orbitron',system-ui;
      font-size:46px;
      letter-spacing:1.7px;
      text-transform:uppercase;
      text-shadow:0 0 40px var(--glow), 0 0 80px rgba(120,210,255,.14);
      line-height:1.02;
    }
    .badge{
      display:inline-flex;width:max-content;
      padding:7px 12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      font-family:'Orbitron',system-ui;
      font-size:12px; letter-spacing:1.15px;
      color:rgba(240,246,255,.78);
      box-shadow:0 0 26px rgba(120,210,255,.10);
      margin-top:6px;
    }
    .sub{color:var(--muted); font-size:16px; max-width:980px; line-height:1.35}

    .nav{display:flex;gap:10px;flex-wrap:wrap}
    .pill{
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.05);
      color:rgba(240,246,255,.86);
      padding:10px 14px;
      border-radius:999px;
      cursor:pointer;
      font-weight:1000;
      user-select:none;
      font-size:14px;
      letter-spacing:.35px;
      transition:transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
    }
    .pill:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.30)}
    .pill.active{
      background:linear-gradient(90deg, rgba(120,210,255,.34), rgba(200,120,255,.22));
      box-shadow:0 0 34px rgba(120,210,255,.16);
      color:rgba(240,246,255,.96);
    }

    .layout{display:grid; grid-template-columns: 480px 1fr; gap:14px}
    @media (max-width: 1080px){ .layout{grid-template-columns:1fr} }

    .card{
      border:1px solid var(--stroke);
      background:var(--card);
      border-radius:20px;
      padding:16px;
      box-shadow:0 14px 80px rgba(0,0,0,.40);
      backdrop-filter:blur(10px);
    }
    .card h2{margin:0 0 8px; font-size:19px; letter-spacing:.4px}
    .mini{color:var(--muted); font-size:14px; line-height:1.35}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; color:rgba(240,246,255,.86)}
    label{display:block; margin-top:10px; font-size:14px; color:var(--muted)}
    input,select,button{
      width:100%;
      padding:12px 12px;
      margin-top:8px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(10,14,24,.62);
      color: rgba(240,246,255,.92);
      outline:none;
      font-size:16px;
    }
    button{
      cursor:pointer;
      font-weight:1000;
      letter-spacing:.6px;
      transition: transform .08s ease, border-color .15s ease, box-shadow .15s ease, filter .15s ease;
      user-select:none;
      position:relative;
      overflow:hidden;
      text-transform:uppercase;
    }
    button:hover{transform:translateY(-1px); border-color:rgba(255,255,255,.32); filter:saturate(1.12)}
    button:disabled{opacity:.55; cursor:not-allowed; filter:none; transform:none}
    .primary{
      background: linear-gradient(90deg, rgba(120,210,255,.34), rgba(200,120,255,.22));
      box-shadow:0 0 44px rgba(120,210,255,.16);
    }
    .primary::after{
      content:"";
      position:absolute; inset:-60% -60%;
      background: radial-gradient(circle at 28% 22%, rgba(255,255,255,.20), transparent 45%);
      transform: rotate(10deg);
      opacity:.85;
      pointer-events:none;
    }
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .row > button{flex:1; min-width:170px}
    .hr{height:1px; background:rgba(255,255,255,.12); margin:12px 0}
    .kpi{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; margin-top:10px}
    @media (max-width: 680px){ .kpi{grid-template-columns:1fr} }
    .kpi .box{border:1px solid rgba(255,255,255,.12);border-radius:16px;padding:10px 12px;background: rgba(255,255,255,.03)}
    .kpi b{display:block; font-size:14px; color:rgba(240,246,255,.78); margin-bottom:4px}
    .kpi span{font-size:16px}
    .plotcard{padding:10px 12px}
    #plotSparc,#plotLocuss{height:820px}
    #plotGlobal{height:820px}

    footer{
      position:relative;
      padding:18px 16px 24px;
      text-align:center;
      color:rgba(240,246,255,.60);
      font-size:13px;
    }

    /* ===== PREMIUM ADD-ONS ===== */
    .heroRow{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:12px;
      align-items:stretch;
    }

    .heroKpis{
      flex: 1 1 520px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border-radius:18px;
      padding:12px 14px;
      box-shadow: 0 18px 90px rgba(0,0,0,.34);
      backdrop-filter: blur(10px);
    }

    .heroKpis .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    @media (max-width: 720px){
      .heroKpis .grid{ grid-template-columns:1fr; }
    }

    .heroKpis .k{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.03);
      border-radius:14px;
      padding:10px 12px;
    }
    .heroKpis .k b{
      display:block;
      font-size:12px;
      letter-spacing:.35px;
      color: rgba(240,246,255,.72);
      margin-bottom:6px;
    }
    .heroKpis .k span{
      font-size:15px;
      color: rgba(240,246,255,.92);
    }

    .quickLinks{
      margin-top:10px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .quickLinks a{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.05);
      text-decoration:none;
      color: rgba(240,246,255,.90);
      font-weight:950;
      letter-spacing:.25px;
      transition: transform .10s ease, border-color .18s ease, box-shadow .18s ease, filter .18s ease;
    }
    .quickLinks a:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.30);
      box-shadow: 0 14px 50px rgba(0,0,0,.22);
      filter:saturate(1.10);
    }

    .heroShot{
      flex: 1 1 360px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.03);
      border-radius:18px;
      padding:10px;
      box-shadow: 0 18px 90px rgba(0,0,0,.34);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .heroShot img{
      width:100%;
      height:auto;
      display:block;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      opacity:.96;
    }
    .heroShot .cap{
      margin-top:8px;
      color: rgba(240,246,255,.62);
      font-size:12.5px;
    }
  </style>
</head>

<body>
  <div class="space"></div>

  <div class="wrap">
    <div class="top">
      <div>
        <h1>Millennium Falcon</h1>

        <div class="badge">SPARC (175) · LoCuSS (40) · One-Click Export · Auto-Load Ready</div>

        <div class="sub">
          <b>What to do:</b> choose <b>SPARC</b> or <b>LoCuSS</b>, set the input constant, and click <b>Run/Compute</b>.<br/>
          <b>What you get:</b> predicted curves/outputs + error metrics, with <b>PNG</b> and <b>CSV</b> export in one click.<br/>
          <span style="color:var(--muted2)">Runs fully in your browser (no server). SPARC dataset auto-loads from this repository.</span>
          <br/>
          <span style="color:var(--muted2)">
            <b>Key point:</b> <br/> single global constant applied to the full sample — <b>no per-object fitting</b>, no individual tuning.
          </span>
        </div>

        <!-- PREMIUM: demo notice + quick links + KPI + screenshot -->
        <div class="heroRow">

          <div class="heroKpis">
            <div class="mini" style="margin-bottom:10px">
              <b>Live demo:</b> on page load, the tool automatically runs the first valid SPARC galaxy.
              <span style="color:var(--muted2)">If auto-load fails, use Manual load or Downloads.</span>
            </div>

            <div class="grid">
              <div class="k">
                <b>Dataset</b>
                <span id="heroDataset">Auto-loading…</span>
              </div>
              <div class="k">
                <b>Selected</b>
                <span id="heroSelected">—</span>
              </div>
              <div class="k">
                <b>RMS</b>
                <span id="heroRms">—</span>
              </div>
            </div>

            
          </div>

          </div>

        </div>
      </div>

      <div class="nav">
        <div class="pill active" data-view="sparc">SPARC Galaxies</div>
        <div class="pill" data-view="locuss">LoCuSS Clusters</div>
        <div class="pill" data-view="dwarfs">Dwarfs</div>
        <div class="pill" data-view="downloads">Downloads</div>
        <div class="pill" data-view="global">Global Tests</div>
      </div>
    </div>

    <!-- SPARC -->
    <section id="view-sparc">
      <div class="layout">
        <div class="card">
          <h2>SPARC Rotation Curves (175)</h2>
          <div class="mini">Auto-load is ON. Manual load remains as fallback.</div>
          <div class="mini" style="margin-top:6px"><b>Quickstart:</b> (1) Pick a galaxy → (2) Click <b>Run</b>.</div>

          <div id="zipStatus" class="mini" style="margin-top:10px">Loading SPARC database…</div>

<div class="row" style="gap:10px; flex-wrap:wrap; margin-top:10px;">
  <button id="btnGoV12" type="button">v12 Theory</button>
  <button id="btnToggleV12" type="button">Show/Hide v12</button>
</div>

<div id="lawBanner" style="margin-top:10px;padding:10px 12px;border:1px solid rgba(255,255,255,.12);border-radius:12px;background:rgba(0,0,0,.25);font-size:14px;line-height:1.35;display:none;"></div>

          <label>Manual load (Rotmod_LTG.zip)</label>
          <input id="sparcFile" type="file" accept=".zip"/>
          <div class="mini" id="perfOut" style="margin-top:6px"></div>

          <label>Galaxy</label>
          <select id="galaxySelect" disabled></select>

          <label>τ (seconds) → mapped to a⋆ (galactic scale)</label>
          <input id="tau" type="number" step="any" value="1.2831e-25"/>

          <label>Optional: override a⋆ (m/s²)</label>
          <input id="astarOverride" type="number" step="any" placeholder=""/>

          <div class="row" style="margin-top:10px">
            <button class="primary" id="btnRunGalaxy" disabled>Run Galaxy</button>
            <button id="btnLoadZip" disabled>Load ZIP</button>
            <button id="btnCSV" disabled>Download CSV</button>
            <button id="btnPNG" disabled>Download PNG</button>
          </div>

          <div class="hr"></div>

          <div class="kpi">
            <div class="box"><b>Galaxy</b><span id="kpiGalaxy">—</span></div>
            <div class="box"><b>RMS (km/s)</b><span id="kpiRMS">—</span></div>
            <div class="box"><b>a⋆ (m/s²)</b><span id="kpiAstar">—</span></div>
          </div>

          <div class="hr"></div>

          <div class="mini">
            <b>Definition</b><br/>
            <span class="mono">Vbar² = Vgas² + Vdisk² + Vbulge²</span><br/>
            <span class="mono">aN(r) = Vbar² / r</span><br/>
            <span class="mono">a(r) = √(aN·a⋆)</span><br/>
            <span class="mono">Vpred(r) = √(r·a)</span>
          </div>
        </div>

        <div class="card plotcard"><div id="plotSparc"></div></div>
      </div>
    </section>

    <!-- LoCuSS -->
    <section id="view-locuss" style="display:none">
      <div class="layout">
        <div class="card">
          <h2>LoCuSS R500 Tester (40)</h2>
          <div class="mini">Compute ξ and ξtop, then export plot/table.</div>
          <div class="mini" style="margin-top:6px"><b>Quickstart:</b> (1) Choose cluster → (2) Click <b>Compute</b>.</div>

          <label>a⋆ (m/s²)</label>
          <input id="locussAstar" type="number" step="any" value="1.55e-10"/>

          <label>ε (global slope removal)</label>
          <input id="locussEps" type="number" step="any" value="0.704"/>

          <label>Cluster</label>
          <select id="clusterSelect"></select>

          <div class="row" style="margin-top:10px">
            <button class="primary" id="btnRunLocuss">Compute</button>
            <button id="btnLocussCSV">Download CSV</button>
            <button id="btnLocussPNG">Download PNG</button>
            <button id="btnReset">Reset defaults</button>
          </div>

          <div class="hr"></div>

          <div class="row">
            <button id="btnHistXi">Hist ξ</button>
            <button id="btnHistTop">Hist ξtop</button>
            <button id="btnXiVsM">ξ vs MWL</button>
            <button id="btnTopVsM">ξtop vs MWL</button>
          </div>

          <div class="hr"></div>
          <div class="mini" id="locussOut"></div>
        </div>

        <div class="card plotcard"><div id="plotLocuss"></div></div>
      </div>
    </section>

    <!-- ===== Dwarfs (McConnachie / Wolf) ===== -->
<section id="view-dwarfs" style="display:none; margin-top:16px">
  <h2 style="margin:10px 0">Dwarf Galaxies</h2>

  <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center">
    <input id="dwarfFile" type="file" accept=".csv,.txt,.dat" />

    <button id="btnRunDwarfs" disabled>Run Dwarfs</button>
    <button id="btnDwarfsCSV" disabled>Export Dwarfs CSV</button>
    <button id="btnDwarfsPNG" disabled>Export Dwarfs PNG</button>
  </div>

  <div id="dwarfsOut" style="margin-top:10px"></div>

  <div id="plotDwarfs" style="height:520px; margin-top:10px"></div>
</section>

<!-- Downloads -->
    <section id="view-downloads" style="display:none">
      <div class="card">
        <h2>Downloads</h2>
        <div class="mini">
          <b>Needed file (optional):</b> <span class="mono">Rotmod_LTG.zip</span><br/>
          If auto-load fails, download the SPARC zip and load it manually using the file picker.<br/>
          <span style="color:var(--muted2)">Tip: keep the zip in the repo root for best auto-load behavior.</span>
          <br/><br/>
          <span style="color:rgba(240,246,255,.60)">
            All computations are performed locally in your browser. No data is sent to any server.
          </span>
        </div>
      </div>
    </section>

    <!-- Global Tests -->
    <section id="view-global" style="display:none">
      <div class="layout">
        <div class="card">
          <h2>Global Tests</h2>
          <div class="mini">
            One-click global views: <b>BTFR</b> (SPARC 175) and <b>LoCuSS</b> (40).
          </div>

          <div class="hr"></div>

          <div class="row">
  <button id="btnBTFR" type="button">Build BTFR (175)</button>
</div>


            <button class="primary" id="btnGlobalRMS">Global RMS (175)</button>
          <button id="btnGlobalCSV" type="button" disabled>Download Global CSV</button>



            <button id="btnLocussGlobal">LoCuSS: Mdyn vs Mbar</button>
          </div>

          <div class="hr"></div>

          <div class="mini" id="globalOut"></div>
        </div>

        <div class="card plotcard"><div id="plotGlobal"></div></div>
      </div>

      <div class="hr"></div>

      <div class="mini" style="padding:12px;border:1px solid rgba(255,255,255,.14);border-radius:16px;background:rgba(255,255,255,.03)">
        <b>Falsifiability:</b> If you find an object that does not match using <b>one global constant</b> (no per-object fitting), the claim is falsified.
      </div>
    </section>


  </div><!-- /wrap -->

  <footer>
    © 2026 José Fabián Vallejos — Argentina<br/>
    Born in Argentina, created for humanity<br/>
    <span style="color:rgba(240,246,255,.45)">Browser-only tool for SPARC galaxies & LoCuSS clusters</span>
    <br/>
    <span style="color:rgba(240,246,255,.40)">
      Educational & exploratory tool. Uses public SPARC and LoCuSS datasets.
    </span>
  </footer>

  
  <script>
    (function(){
      const pills = Array.from(document.querySelectorAll('.pill[data-view]'));
      const views = {
        sparc: document.getElementById('view-sparc'),
        locuss: document.getElementById('view-locuss'),
        dwarfs: document.getElementById('view-dwarfs'),
        downloads: document.getElementById('view-downloads'),
        global: document.getElementById('view-global'),
      };
      function show(name){
        pills.forEach(p=>p.classList.toggle('active', p.dataset.view===name));
        Object.entries(views).forEach(([k,el])=>{ if(el) el.style.display = (k===name ? '' : 'none'); });
        setTimeout(()=>{
          ['plotSparc','plotLocuss','plotDwarfs','plotGlobal'].forEach(id=>{
            const el = document.getElementById(id);
            if(el && window.Plotly){ try{ Plotly.Plots.resize(el);}catch(e){} }
          });
        }, 80);
      }
      pills.forEach(p=>p.addEventListener('click', ()=>show(p.dataset.view)));
      show('sparc');
    })();
  </script>
<script>
// ==========================================================
// Millennium Falcon — Inline SPARC CSV backend (no conflicts)
// - FileReader + robust parser (comma OR whitespace)
// - QUOT/OHM motor: geff = sqrt(gN^2 + gN*a*)
// - Reads UI inputs: tau + astarOverride (override wins)
// ==========================================================
window.MF = window.MF || {};
(function(MF){
  const KPC_TO_M = 3.085677581e19;
  MF.SPARC_ROWS = [];

  function el(id){ return document.getElementById(id); }

  MF.readTextFile = function(file){
    return new Promise((resolve,reject)=>{
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.onerror = err => reject(err);
      reader.readAsText(file);
    });
  };

  MF.parseSPARC = function(text){
    const lines = text.split(/\r?\n/).filter(l=>l.trim() && !l.trim().startsWith("#"));
    MF.SPARC_ROWS = [];
    for(const line of lines){
      const trimmed = line.trim();
      const parts = trimmed.includes(",") ? trimmed.split(",") : trimmed.split(/\s+/);
      const nums = parts.map(s=>Number(s));
      if(!isFinite(nums[0]) || !isFinite(nums[1])) continue;
      MF.SPARC_ROWS.push({
        r: nums[0],
        vobs: nums[1],
        vgas: nums[2] ?? 0,
        vdisk: nums[3] ?? 0,
        vbulge: nums[4] ?? 0
      });
    }

    // Enable run/export
    const ok = MF.SPARC_ROWS.length > 0;
    if (el("btnRunGalaxy")) el("btnRunGalaxy").disabled = !ok;
    if (el("btnCSV")) el("btnCSV").disabled = !ok;
    if (el("btnPNG")) el("btnPNG").disabled = !ok;

    if (el("kpiGalaxy")) el("kpiGalaxy").textContent = ok ? "Loaded (CSV)" : "—";
    if (el("heroDataset")) el("heroDataset").textContent = ok ? "Manual CSV" : "—";
    return MF.SPARC_ROWS.length;
  };

  function getAstar(){
    const override = parseFloat(el("astarOverride")?.value || "");
    if (isFinite(override) && override>0) return override;
    return 1.5e-10;
  }

  MF.predictVel = function(){
    if(!MF.SPARC_ROWS.length) return;

    const ML = 0.51;   // global
    const ASTAR = getAstar();

    const rads=[], obs=[], pred=[];
    for(const p of MF.SPARC_ROWS){
      const Vbar2 = (p.vgas*p.vgas) + ML*((p.vdisk*p.vdisk) + (p.vbulge*p.vbulge));
      const r_m = p.r * KPC_TO_M;
      const gN = (Vbar2 * 1e6) / r_m;          // (km/s)^2 -> (m/s)^2
      const geff = Math.sqrt(gN*gN + gN*ASTAR);
      const v_kms = Math.sqrt(r_m*geff)/1000;

      rads.push(p.r);
      obs.push(p.vobs);
      pred.push(v_kms);
    }

    MF.plotGalaxy(rads, obs, pred);
    MF.updateRMS(obs, pred, ASTAR);
  };

  MF.plotGalaxy = function(r, o, p){
    if(!window.Plotly) return;
    Plotly.newPlot("plotSparc",[
      {x:r, y:o, name:"Observed", mode:"lines+markers"},
      {x:r, y:p, name:"QUOT", mode:"lines"}
    ], {
      margin:{l:50,r:20,t:25,b:45},
      paper_bgcolor:"rgba(0,0,0,0)",
      plot_bgcolor:"rgba(0,0,0,0)",
      xaxis:{title:"r (kpc)"},
      yaxis:{title:"V (km/s)"}
    });
  };

  MF.updateRMS = function(o, p, ASTAR){
    let s=0;
    for(let i=0;i<o.length;i++) s += (o[i]-p[i])*(o[i]-p[i]);
    const rms = Math.sqrt(s/o.length);

    if (el("kpiRMS")) el("kpiRMS").textContent = rms.toFixed(2);
    if (el("heroRms")) el("heroRms").textContent = rms.toFixed(2) + " km/s";
    if (el("kpiAstar")) el("kpiAstar").textContent = ASTAR.toExponential(3);
    if (el("heroSelected")) el("heroSelected").textContent = el("galaxySelect")?.value || "CSV manual";
  };

  // Wire UI
  const sparcFile = el("sparcFile");
  if (sparcFile){
    sparcFile.addEventListener("change", async (e)=>{
      const file = e.target.files && e.target.files[0];
      if(!file) return;
      const txt = await MF.readTextFile(file);
      MF.parseSPARC(txt);
    });
  }

  if (el("btnRunGalaxy")){
    el("btnRunGalaxy").addEventListener("click", MF.predictVel);
  }

  if (el("btnPNG")){
    el("btnPNG").addEventListener("click", async ()=>{
      if(!window.Plotly) return;
      try{ await Plotly.downloadImage("plotSparc", {format:"png", filename:"millennium_falcon_sparc"}); }catch(e){}
    });
  }

  if (el("btnCSV")){
    el("btnCSV").addEventListener("click", ()=>{
      if(!MF.SPARC_ROWS.length) return;
      const header = "r_kpc,vobs_kms,vgas_kms,vdisk_kms,vbulge_kms\n";
      const body = MF.SPARC_ROWS.map(p=>[p.r,p.vobs,p.vgas,p.vdisk,p.vbulge].join(",")).join("\n");
      const blob = new Blob([header+body], {type:"text/csv"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "sparc_loaded.csv";
      a.click();
      setTimeout(()=>URL.revokeObjectURL(a.href), 600);
    });
  }
})(window.MF);
</script>

<!-- Your app logic -->
 <!-- Optional external app.js. If kept, ensure it does NOT redefine MF.* or bind duplicate handlers. -->
  
<section id="v12Dynamics" style="margin:40px auto 10px; max-width:1100px; padding:20px; border-top:1px solid rgba(255,255,255,.12);">
  <h2 style="margin:0 0 10px; font-size:20px;">v12 — Dynamic Coherence Field (Vallejos)</h2>
  <p style="margin:0 0 10px; font-size:14px; line-height:1.5;">
    In v12, the empirical coherence factor <b>C</b> is promoted from a numerical parameter to a physical scalar field Φ(x,t).
    The framework becomes a scalar–tensor theory where matter couples conformally to spacetime through Φ.
  </p>

  <h3 style="margin:14px 0 8px; font-size:16px;">Action Principle</h3>
  <pre style="margin:0 0 10px; padding:12px; border-radius:10px; background:rgba(0,0,0,.35); overflow:auto; font-size:13px; line-height:1.35;">
S = ∫ d⁴x √−g [ R/(16πG)
              + ½ ∂μΦ ∂μΦ
              − V(Φ)
              + Lm(e^{2βΦ} gμν , ψm) ]
  </pre>

  <h3 style="margin:14px 0 8px; font-size:16px;">Field Equation</h3>
  <pre style="margin:0 0 10px; padding:12px; border-radius:10px; background:rgba(0,0,0,.35); overflow:auto; font-size:13px; line-height:1.35;">
□Φ = dV/dΦ − β T
  </pre>

  <h3 style="margin:14px 0 8px; font-size:16px;">Emergent Vallejos Factor</h3>
  <pre style="margin:0 0 10px; padding:12px; border-radius:10px; background:rgba(0,0,0,.35); overflow:auto; font-size:13px; line-height:1.35;">
C = e^{-2βΦ}
V → V / √C
  </pre>

  <ul style="margin:8px 0 0 18px; font-size:14px; line-height:1.5;">
    <li>Φ defines a local coherence state of spacetime.</li>
    <li>C &lt; 1 corresponds to reduced effective inertia in the effective (conformal) frame.</li>
    <li>The v11 velocity law is the quasi-static astrophysical limit of this field theory.</li>
  </ul>

  <p style="margin:14px 0 0; font-size:13px; opacity:.85; line-height:1.5;">
    Status: this section is the theoretical field framework (paper-grade). All plots above correspond to stationary astrophysical solutions.
  </p>
</section>
<section id="ipNotice" style="margin:28px auto 10px; max-width:1100px; padding:16px 18px; border-top:1px solid rgba(255,255,255,.12); opacity:0.95;">
  <h3 style="margin:0 0 8px; font-size:16px;">Propiedad Intelectual &amp; Uso</h3>
  <p style="margin:0 0 8px; font-size:13px; line-height:1.45;">
    © <span id="ipYear"></span> José Fabián Vallejos. Este software, su interfaz, el modelo matemático implementado, y la metodología de cálculo asociada
    constituyen obra original y están protegidos por derechos de autor (Argentina – Ley 11.723) y convenios internacionales.
  </p>
  <p style="margin:0 0 8px; font-size:13px; line-height:1.45;">
    <strong>INPI Argentina:</strong> Para registro/depósito y constancias formales, completa aquí tus datos cuando corresponda:
    <em>Expediente/Trámite INPI:</em> <span style="border-bottom:1px dotted rgba(255,255,255,.35); padding:0 6px;">__________</span>
  </p>
  <p style="margin:0; font-size:12.5px; line-height:1.45; opacity:0.9;">
    Prohibida la reproducción, re-implementación, ingeniería inversa o uso comercial sin autorización escrita del autor.
    Para licencias o acuerdos: reemplaza este texto con tu contacto oficial.
  </p>
</section>
<script>
  try{ document.getElementById("ipYear").textContent = new Date().getFullYear(); }catch(e){}
</script>


<script>
(function(){
  function $(id){ return document.getElementById(id); }
  function go(){ var s=$("v12Dynamics"); if(s) s.scrollIntoView({behavior:"smooth", block:"start"}); }
  function toggle(){
    var s=$("v12Dynamics"); if(!s) return;
    s.style.display = (s.style.display==="none") ? "block" : "none";
  }
  document.addEventListener("DOMContentLoaded", function(){
    var a=$("btnGoV12"); if(a) a.addEventListener("click", go);
    var b=$("btnToggleV12"); if(b) b.addEventListener("click", toggle);
  });
})();
</script>


<script>
(function(){"use strict";var d="InVzZSBzdHJpY3QiOyB3aW5kb3cuX19BUFBfVkVSU0lPTl9fID0gIk1GX0tFUk5FTF9KT1VMRV92Nl8yMDI2LTAyLTIwIjsgY29uc29sZS5sb2coIltNaWxsZW5uaXVtIEZhbGNvbl0gYXBwLmpzIGxvYWRlZDoiLCB3aW5kb3cuX19BUFBfVkVSU0lPTl9fKTsgY29uc3QgS0VSTkVMX01PREUgPSAiU1FSVCI7IGNvbnN0IENPTlNUID0geyBNTF9VTklWOiAwLjUxLCBBU1RBUjogMS41ZS0xMCwgS1BDX1RPX006IDMuMDg1Njc3NTgxNDkxMzY3ZTE5LCBLTVBTX1RPX01QUzogMTAwMCwgfTsgY29uc3QgJCA9IChpZCkgPT4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyBjb25zdCBlbCA9IHsgdGF1OiAkKCJ0YXUiKSwgYXN0YXJPdmVycmlkZTogJCgiYXN0YXJPdmVycmlkZSIpLCB6aXBTdGF0dXM6ICQoInppcFN0YXR1cyIpLCBzcGFyY0ZpbGU6ICQoInNwYXJjRmlsZSIpLCBnYWxheHlTZWxlY3Q6ICQoImdhbGF4eVNlbGVjdCIpLCBidG5SdW5HYWxheHk6ICQoImJ0blJ1bkdhbGF4eSIpLCBidG5QTkc6ICQoImJ0blBORyIpLCBidG5DU1Y6ICQoImJ0bkNTViIpLCBidG5SZXNldDogJCgiYnRuUmVzZXQiKSwgYnRuR2xvYmFsUk1TOiAkKCJidG5HbG9iYWxSTVMiKSwgYnRuR2xvYmFsQ1NWOiAkKCJidG5HbG9iYWxDU1YiKSwgZ2xvYmFsT3V0OiAkKCJnbG9iYWxPdXQiKSwgYnRuUnVuRHdhcmZzOiAkKCJidG5SdW5Ed2FyZnMiKSwgZHdhcmZGaWxlOiAkKCJkd2FyZkZpbGUiKSwgZHdhcmZzT3V0OiAkKCJkd2FyZnNPdXQiKSwgYnRuRHdhcmZzQ1NWOiAkKCJidG5Ed2FyZnNDU1YiKSwgYnRuRHdhcmZzUE5HOiAkKCJidG5Ed2FyZnNQTkciKSwga3BpR2FsYXh5OiAkKCJrcGlHYWxheHkiKSwga3BpUk1TOiAkKCJrcGlSTVMiKSwga3BpQXN0YXI6ICQoImtwaUFzdGFyIiksIHBsb3RTcGFyYzogJCgicGxvdFNwYXJjIiksIHBsb3RHbG9iYWw6ICQoInBsb3RHbG9iYWwiKSwgcGxvdER3YXJmczogJCgicGxvdER3YXJmcyIpLCB2aWV3U3BhcmM6ICQoInZpZXctc3BhcmMiKSwgdmlld0dsb2JhbDogJCgidmlldy1nbG9iYWwiKSwgdmlld0R3YXJmczogJCgidmlldy1kd2FyZnMiKSwgdmlld0Rvd25sb2FkczogJCgidmlldy1kb3dubG9hZHMiKSwgdmlld0xvY3VzczogJCgidmlldy1sb2N1c3MiKSwgYnRuUnVuTG9jdXNzOiAkKCJidG5SdW5Mb2N1c3MiKSwgY2x1c3RlclNlbGVjdDogJCgiY2x1c3RlclNlbGVjdCIpLCBsb2N1c3NPdXQ6ICQoImxvY3Vzc091dCIpLCBwbG90TG9jdXNzOiAkKCJwbG90TG9jdXNzIiksIGJ0bkxvY3Vzc0dsb2JhbDogJCgiYnRuTG9jdXNzR2xvYmFsIiksIGJ0bkxvY3Vzc0NTVjogJCgiYnRuTG9jdXNzQ1NWIiksIGJ0bkxvY3Vzc1BORzogJCgiYnRuTG9jdXNzUE5HIiksIGxvY3Vzc0VwczogJCgibG9jdXNzRXBzIiksIGxvY3Vzc0FzdGFyOiAkKCJsb2N1c3NBc3RhciIpLCBwZXJmT3V0OiAkKCJwZXJmT3V0IiksIGJ0bkJURlI6ICQoImJ0bkJURlIiKSwgfTsgZnVuY3Rpb24gYXNzZXRDYW5kaWRhdGVzKGZpbGVuYW1lKXsgY29uc3Qgb3JpZ2luID0gd2luZG93LmxvY2F0aW9uLm9yaWdpbjsgY29uc3QgcGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTsgY29uc3QgYmFzZSA9IHBhdGguZW5kc1dpdGgoIi8iKSA/IHBhdGggOiBwYXRoLnNsaWNlKDAsIHBhdGgubGFzdEluZGV4T2YoIi8iKSsxKTsgY29uc3QgcmVwb0Jhc2UgPSBvcmlnaW4gKyBiYXNlOyBjb25zdCByb290QmFzZSA9IG9yaWdpbiArICIvIjsgcmV0dXJuIFsgIi4vIitmaWxlbmFtZSwgZmlsZW5hbWUsIHJlcG9CYXNlICsgZmlsZW5hbWUsIHJvb3RCYXNlICsgZmlsZW5hbWUgXTsgfSBjb25zdCBzdGF0ZSA9IHsgemlwOiBudWxsLCBmaWxlczogW10sIGdhbGF4aWVzOiBbXSwgY3VycmVudEdhbGF4eTogbnVsbCwgY3VycmVudFJvd3M6IG51bGwsIGxhc3RDU1Y6IG51bGwsIGxhc3RQTkdUYXJnZXQ6IG51bGwsIH07IGZ1bmN0aW9uIGNsYW1wKHgsIGEsIGIpeyByZXR1cm4gTWF0aC5tYXgoYSwgTWF0aC5taW4oYiwgeCkpOyB9IGZ1bmN0aW9uIHNhZmVOdW0oeCl7IGNvbnN0IHYgPSBOdW1iZXIoeCk7IHJldHVybiBOdW1iZXIuaXNGaW5pdGUodikgPyB2IDogTmFOOyB9IGZ1bmN0aW9uIHJtcyhhcnIpeyBsZXQgcyA9IDAsIG4gPSAwOyBmb3IgKGNvbnN0IHYgb2YgYXJyKXsgaWYgKE51bWJlci5pc0Zpbml0ZSh2KSl7IHMgKz0gdip2OyBuKys7IH0gfSByZXR1cm4gbiA/IE1hdGguc3FydChzL24pIDogTmFOOyB9IGZ1bmN0aW9uIHZiYXIyX2ttMnMyKHJvdyl7IGNvbnN0IHZnYXMgPSByb3cuVmdhczsgY29uc3QgdmRpc2sgPSByb3cuVmRpc2s7IGNvbnN0IHZidWwgPSByb3cuVmJ1bDsgaWYgKCFbdmdhcywgdmRpc2ssIHZidWxdLmV2ZXJ5KE51bWJlci5pc0Zpbml0ZSkpIHJldHVybiBOYU47IHJldHVybiB2Z2FzKnZnYXMgKyBDT05TVC5NTF9VTklWKih2ZGlzayp2ZGlzayArIHZidWwqdmJ1bCk7IH0gZnVuY3Rpb24gYU5fbXBzMihyb3cpeyBjb25zdCB2YjIgPSB2YmFyMl9rbTJzMihyb3cpOyBjb25zdCByX20gPSByb3cuUl9rcGMgKiBDT05TVC5LUENfVE9fTTsgaWYgKCFOdW1iZXIuaXNGaW5pdGUodmIyKSB8fCAhKHJfbSA+IDApKSByZXR1cm4gTmFOOyBjb25zdCB2YjJfbTJzMiA9IHZiMiAqIChDT05TVC5LTVBTX1RPX01QUyoqMik7IHJldHVybiB2YjJfbTJzMiAvIHJfbTsgfSBmdW5jdGlvbiBhS2VybmVsX21wczIoYU4sIGFTdGFyKXsgaWYgKCEoYU4gPiAwKSB8fCAhKGFTdGFyID4gMCkpIHJldHVybiAwOyBpZiAoS0VSTkVMX01PREUgPT09ICJPSE1fSEFMRiIpeyByZXR1cm4gMC41KihhTiArIE1hdGguc3FydChhTiphTiArIDQqYU4qYVN0YXIpKTsgfSByZXR1cm4gTWF0aC5zcXJ0KGFOKmFOICsgYU4qYVN0YXIpOyB9IGZ1bmN0aW9uIGNvaGVyZW5jZUNhbUIocm93LCBhTiwgYVN0YXIpeyBjb25zdCB2YjIgPSB2YmFyMl9rbTJzMihyb3cpOyBjb25zdCBmZyA9IChOdW1iZXIuaXNGaW5pdGUodmIyKSAmJiB2YjIgPiAwKSA/IGNsYW1wKChyb3cuVmdhcypyb3cuVmdhcykvdmIyLCAwLCAxKSA6IDA7IGNvbnN0IHggPSAoYU4gPiAwKSA/IChhU3RhciAvIGFOKSA6IDFlNjsgY29uc3QgYWxwaGEgPSA3LjU7IGNvbnN0IGJldGEgPSAwLjY1OyBjb25zdCBDID0gMSAvICgxICsgYWxwaGEgKiBmZyAqIE1hdGgucG93KHgsIGJldGEpKTsgcmV0dXJuIGNsYW1wKEMsIDAuMDgsIDEuMCk7IH0gZnVuY3Rpb24gaXNDYW1CTmFtZShuYW1lKXsgcmV0dXJuIC9eY2FtYi9pLnRlc3QoU3RyaW5nKG5hbWUgfHwgIiIpKTsgfSBmdW5jdGlvbiBnZXRBc3RhcigpeyBjb25zdCB1c2VyID0gc2FmZU51bShlbC5hc3Rhck92ZXJyaWRlPy52YWx1ZSk7IHJldHVybiAoTnVtYmVyLmlzRmluaXRlKHVzZXIpICYmIHVzZXIgPiAwKSA/IHVzZXIgOiBDT05TVC5BU1RBUjsgfSBmdW5jdGlvbiBwYXJzZVJvdG1vZFRleHQodGV4dCl7IGNvbnN0IGxpbmVzID0gU3RyaW5nKHRleHQpLnNwbGl0KC9ccj9cbi8pLm1hcChsID0+IGwudHJpbSgpKS5maWx0ZXIobCA9PiBsICYmICFsLnN0YXJ0c1dpdGgoIiMiKSk7IGlmICghbGluZXMubGVuZ3RoKSByZXR1cm4gW107IGNvbnN0IGZpcnN0ID0gbGluZXNbMF07IGNvbnN0IGhhc0xldHRlcnMgPSAvW0EtWmEtel0vLnRlc3QoZmlyc3QpOyBsZXQgc3RhcnQgPSAwOyBsZXQgaGVhZGVyID0gbnVsbDsgaWYgKGhhc0xldHRlcnMpeyBoZWFkZXIgPSBmaXJzdC5zcGxpdCgvW1xzLF0rLykubWFwKHMgPT4gcy50cmltKCkpOyBzdGFydCA9IDE7IH0gY29uc3Qgcm93cyA9IFtdOyBmb3IgKGxldCBpID0gc3RhcnQ7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKyl7IGNvbnN0IHBhcnRzID0gbGluZXNbaV0uc3BsaXQoL1tccyxdKy8pOyBpZiAocGFydHMubGVuZ3RoIDwgNCkgY29udGludWU7IGxldCBSX2twYywgVm9icywgZVZvYnMsIFZnYXMsIFZkaXNrLCBWYnVsOyBpZiAoaGVhZGVyKXsgY29uc3QgaWR4ID0gKG5hbWUpID0+IGhlYWRlci5maW5kSW5kZXgoaCA9PiBoLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUudG9Mb3dlckNhc2UoKSk7IGNvbnN0IHBpY2sgPSAobmFtZSwgZmFsbGJhY2tJZHgpID0+IHsgY29uc3QgaiA9IGlkeChuYW1lKTsgcmV0dXJuIHNhZmVOdW0ocGFydHNbKGogPj0gMCkgPyBqIDogZmFsbGJhY2tJZHhdKTsgfTsgUl9rcGMgPSBwaWNrKCJSIiwgMCk7IFZvYnMgPSBwaWNrKCJWb2JzIiwgMSk7IGVWb2JzID0gcGljaygiZVZvYnMiLCAyKTsgVmdhcyA9IHBpY2soIlZnYXMiLCAzKTsgVmRpc2sgPSBwaWNrKCJWZGlzayIsIDQpOyBWYnVsID0gcGljaygiVmJ1bCIsIDUpOyB9IGVsc2UgeyBSX2twYyA9IHNhZmVOdW0ocGFydHNbMF0pOyBWb2JzID0gc2FmZU51bShwYXJ0c1sxXSk7IGVWb2JzID0gc2FmZU51bShwYXJ0c1syXSk7IFZnYXMgPSBzYWZlTnVtKHBhcnRzWzNdKTsgVmRpc2sgPSBzYWZlTnVtKHBhcnRzWzRdKTsgVmJ1bCA9IHNhZmVOdW0ocGFydHNbNV0pOyB9IGlmICghTnVtYmVyLmlzRmluaXRlKFJfa3BjKSB8fCAhTnVtYmVyLmlzRmluaXRlKFZvYnMpKSBjb250aW51ZTsgcm93cy5wdXNoKHsgUl9rcGMsIFZvYnMsIGVWb2JzOiBOdW1iZXIuaXNGaW5pdGUoZVZvYnMpID8gZVZvYnMgOiBOYU4sIFZnYXM6IE51bWJlci5pc0Zpbml0ZShWZ2FzKSA/IFZnYXMgOiAwLCBWZGlzazogTnVtYmVyLmlzRmluaXRlKFZkaXNrKSA/IFZkaXNrIDogMCwgVmJ1bDogTnVtYmVyLmlzRmluaXRlKFZidWwpID8gVmJ1bCA6IDAsIH0pOyB9IHJldHVybiByb3dzOyB9IGZ1bmN0aW9uIGNvbXB1dGVQcmVkaWN0aW9uKGdhbGF4eU5hbWUsIHJvd3MpeyBjb25zdCBhU3RhciA9IGdldEFzdGFyKCk7IGVsLmtwaUFzdGFyICYmIChlbC5rcGlBc3Rhci50ZXh0Q29udGVudCA9IGFTdGFyLnRvRXhwb25lbnRpYWwoMykpOyBjb25zdCBvdXQgPSBbXTsgY29uc3QgcmVzaWR1YWxzID0gW107IGZvciAoY29uc3Qgcm93IG9mIHJvd3MpeyBjb25zdCBhTiA9IGFOX21wczIocm93KTsgbGV0IGFFZmYgPSBhS2VybmVsX21wczIoYU4sIGFTdGFyKTsgaWYgKGlzQ2FtQk5hbWUoZ2FsYXh5TmFtZSkpeyBjb25zdCBDID0gY29oZXJlbmNlQ2FtQihyb3csIGFOLCBhU3Rhcik7IGFFZmYgKj0gQzsgfSBjb25zdCByX20gPSByb3cuUl9rcGMgKiBDT05TVC5LUENfVE9fTTsgY29uc3QgdnByZWRfbXBzID0gTWF0aC5zcXJ0KE1hdGgubWF4KDAsIHJfbSAqIGFFZmYpKTsgY29uc3QgdnByZWQgPSB2cHJlZF9tcHMgLyBDT05TVC5LTVBTX1RPX01QUzsgb3V0LnB1c2goeyBSX2twYzogcm93LlJfa3BjLCBWb2JzOiByb3cuVm9icywgZVZvYnM6IHJvdy5lVm9icywgVmdhczogcm93LlZnYXMsIFZkaXNrOiByb3cuVmRpc2ssIFZidWw6IHJvdy5WYnVsLCBWcHJlZDogdnByZWQsIGFOX21wczI6IGFOLCBhRWZmX21wczI6IGFFZmYsIH0pOyBpZiAoTnVtYmVyLmlzRmluaXRlKHJvdy5Wb2JzKSAmJiBOdW1iZXIuaXNGaW5pdGUodnByZWQpKXsgcmVzaWR1YWxzLnB1c2godnByZWQgLSByb3cuVm9icyk7IH0gfSBjb25zdCBSTVMgPSBybXMocmVzaWR1YWxzKTsgcmV0dXJuIHsgdGFibGU6IG91dCwgUk1TIH07IH0gZnVuY3Rpb24gcGxvdEdhbGF4eShnYWxheHlOYW1lLCB0YWJsZSl7IGNvbnN0IHggPSB0YWJsZS5tYXAociA9PiByLlJfa3BjKTsgY29uc3QgeU9icyA9IHRhYmxlLm1hcChyID0+IHIuVm9icyk7IGNvbnN0IHlQcmVkID0gdGFibGUubWFwKHIgPT4gci5WcHJlZCk7IGNvbnN0IGRhdGEgPSBbIHsgeCwgeTogeU9icywgbW9kZTogIm1hcmtlcnMiLCBuYW1lOiAiT2JzZXJ2ZWQiIH0sIHsgeCwgeTogeVByZWQsIG1vZGU6ICJsaW5lcyIsIG5hbWU6ICJQcmVkaWN0ZWQiIH0sIF07IGNvbnN0IGxheW91dCA9IHsgdGl0bGU6IGdhbGF4eU5hbWUsIHhheGlzOiB7IHRpdGxlOiAiciAoa3BjKSIgfSwgeWF4aXM6IHsgdGl0bGU6ICJWIChrbS9zKSIgfSwgbWFyZ2luOiB7IGw6IDUwLCByOiAyMCwgdDogNTAsIGI6IDQ1IH0sIHBhcGVyX2JnY29sb3I6ICJyZ2JhKDAsMCwwLDApIiwgcGxvdF9iZ2NvbG9yOiAicmdiYSgwLDAsMCwwKSIsIGZvbnQ6IHsgY29sb3I6ICJyZ2JhKDI0MCwyNDYsMjU1LC45MikiIH0sIGxlZ2VuZDogeyBvcmllbnRhdGlvbjogImgiIH0sIH07IFBsb3RseS5uZXdQbG90KGVsLnBsb3RTcGFyYywgZGF0YSwgbGF5b3V0LCB7IHJlc3BvbnNpdmU6IHRydWUsIGRpc3BsYXlsb2dvOiBmYWxzZSB9KTsgc3RhdGUubGFzdFBOR1RhcmdldCA9ICJwbG90U3BhcmMiOyB9IGZ1bmN0aW9uIHBsb3RHbG9iYWxSTVMocG9pbnRzKXsgY29uc3QgeCA9IHBvaW50cy5tYXAocCA9PiBwLlJNUyk7IGNvbnN0IHkgPSBwb2ludHMubWFwKHAgPT4gcC5uYW1lKTsgY29uc3QgZGF0YSA9IFt7IHgsIHksIHR5cGU6ICJiYXIiLCBvcmllbnRhdGlvbjogImgiLCBuYW1lOiAiUk1TIiB9XTsgY29uc3QgbGF5b3V0ID0geyB0aXRsZTogIkdsb2JhbCBSTVMgKGFsbCBnYWxheGllcykiLCB4YXhpczogeyB0aXRsZTogIlJNUyAoa20vcykiIH0sIG1hcmdpbjogeyBsOiAxNDAsIHI6IDIwLCB0OiA1MCwgYjogNDUgfSwgcGFwZXJfYmdjb2xvcjogInJnYmEoMCwwLDAsMCkiLCBwbG90X2JnY29sb3I6ICJyZ2JhKDAsMCwwLDApIiwgZm9udDogeyBjb2xvcjogInJnYmEoMjQwLDI0NiwyNTUsLjkyKSIgfSwgfTsgUGxvdGx5Lm5ld1Bsb3QoZWwucGxvdEdsb2JhbCwgZGF0YSwgbGF5b3V0LCB7IHJlc3BvbnNpdmU6IHRydWUsIGRpc3BsYXlsb2dvOiBmYWxzZSB9KTsgc3RhdGUubGFzdFBOR1RhcmdldCA9ICJwbG90R2xvYmFsIjsgfSBmdW5jdGlvbiBkb3dubG9hZFRleHQoZmlsZW5hbWUsIHRleHQpeyBjb25zdCBibG9iID0gbmV3IEJsb2IoW3RleHRdLCB7IHR5cGU6ICJ0ZXh0L3BsYWluO2NoYXJzZXQ9dXRmLTgiIH0pOyBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOyBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOyBhLmhyZWYgPSB1cmw7IGEuZG93bmxvYWQgPSBmaWxlbmFtZTsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOyBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7IH0gZnVuY3Rpb24gdG9DU1YodGFibGUpeyBjb25zdCBjb2xzID0gWyJSX2twYyIsIlZvYnMiLCJlVm9icyIsIlZnYXMiLCJWZGlzayIsIlZidWwiLCJWcHJlZCIsImFOX21wczIiLCJhRWZmX21wczIiXTsgY29uc3QgbGluZXMgPSBbY29scy5qb2luKCIsIildOyBmb3IgKGNvbnN0IHIgb2YgdGFibGUpeyBsaW5lcy5wdXNoKGNvbHMubWFwKGMgPT4gKHJbY10gPz8gIiIpKS5qb2luKCIsIikpOyB9IHJldHVybiBsaW5lcy5qb2luKCJcbiIpOyB9IGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkUE5HKHBsb3RJZCl7IGNvbnN0IGRpdiA9ICQocGxvdElkKTsgaWYgKCFkaXYpIHJldHVybjsgY29uc3QgZGF0YVVybCA9IGF3YWl0IFBsb3RseS50b0ltYWdlKGRpdiwgeyBmb3JtYXQ6ICJwbmciLCBoZWlnaHQ6IDcwMCwgd2lkdGg6IDExMDAgfSk7IGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7IGEuaHJlZiA9IGRhdGFVcmw7IGEuZG93bmxvYWQgPSBgJHtzdGF0ZS5jdXJyZW50R2FsYXh5IHx8ICJwbG90In0ucG5nYDsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOyB9IGFzeW5jIGZ1bmN0aW9uIGZldGNoQXJyYXlCdWZmZXIodXJsKXsgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godXJsLCB7IGNhY2hlOiAibm8tc3RvcmUiIH0pOyBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBGZXRjaCBmYWlsZWQgJHtyZXMuc3RhdHVzfSBmb3IgJHt1cmx9YCk7IHJldHVybiBhd2FpdCByZXMuYXJyYXlCdWZmZXIoKTsgfSBhc3luYyBmdW5jdGlvbiBsb2FkWmlwRnJvbUFycmF5QnVmZmVyKGFiLCBzb3VyY2VMYWJlbCl7IGNvbnN0IHppcCA9IGF3YWl0IEpTWmlwLmxvYWRBc3luYyhhYik7IHN0YXRlLnppcCA9IHppcDsgY29uc3QgZmlsZXMgPSBbXTsgemlwLmZvckVhY2goKHBhdGgsIGVudHJ5KSA9PiB7IGlmICghZW50cnkuZGlyICYmIC9cLmNzdiQvaS50ZXN0KHBhdGgpKSBmaWxlcy5wdXNoKHsgbmFtZTogcGF0aCwgZW50cnkgfSk7IH0pOyBzdGF0ZS5maWxlcyA9IGZpbGVzOyBzdGF0ZS5nYWxheGllcyA9IGZpbGVzIC5tYXAoZiA9PiBmLm5hbWUpIC5tYXAobmFtZSA9PiBuYW1lLnNwbGl0KCIvIikucG9wKCkpIC5maWx0ZXIobmFtZSA9PiAvX3JvdG1vZFwuKGNzdnxkYXQpJC9pLnRlc3QobmFtZSkpIC5zb3J0KChhLGIpPT5hLmxvY2FsZUNvbXBhcmUoYikpOyBwb3B1bGF0ZUdhbGF4eVNlbGVjdCgpOyBlbC56aXBTdGF0dXMgJiYgKGVsLnppcFN0YXR1cy50ZXh0Q29udGVudCA9IGBTUEFSQyBsaXN0bzogJHtzdGF0ZS5nYWxheGllcy5sZW5ndGh9IGdhbGF4aWFzICgke3NvdXJjZUxhYmVsfSkuYCk7IGlmIChlbC5idG5HbG9iYWxSTVMpIGVsLmJ0bkdsb2JhbFJNUy5kaXNhYmxlZCA9IGZhbHNlOyBpZiAoZWwuYnRuUnVuR2FsYXh5KSBlbC5idG5SdW5HYWxheHkuZGlzYWJsZWQgPSBmYWxzZTsgfSBhc3luYyBmdW5jdGlvbiBsb2FkWmlwRnJvbVJlcG8oKXsgY29uc3QgcGF0aCA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSB8fCAiLyI7IGNvbnN0IGJhc2UgPSBwYXRoLmVuZHNXaXRoKCIvIikgPyBwYXRoIDogcGF0aC5yZXBsYWNlKC9bXlwvXSskLywgIiIpOyBjb25zdCBjYW5kaWRhdGVzID0gWyAiLi9Sb3Rtb2RfTFRHLnppcCIsICJSb3Rtb2RfTFRHLnppcCIsIGJhc2UgKyAiUm90bW9kX0xURy56aXAiLCAiL1JvdG1vZF9MVEcuemlwIiBdOyBpZiAoZWwuYnRuTG9hZFppcCkgZWwuYnRuTG9hZFppcC5kaXNhYmxlZCA9IGZhbHNlOyBlbC56aXBTdGF0dXMgJiYgKGVsLnppcFN0YXR1cy50ZXh0Q29udGVudCA9ICJMb2FkaW5nIFNQQVJDIGRhdGFiYXNl4oCmIik7IGxldCBsYXN0RXJyID0gbnVsbDsgZm9yIChjb25zdCB1cmwgb2YgY2FuZGlkYXRlcyl7IHRyeXsgY29uc3QgYWIgPSBhd2FpdCBmZXRjaEFycmF5QnVmZmVyKHVybCk7IGF3YWl0IGxvYWRaaXBGcm9tQXJyYXlCdWZmZXIoYWIsICJyZXBvIik7IGVsLnppcFN0YXR1cyAmJiAoZWwuemlwU3RhdHVzLnRleHRDb250ZW50ID0gIlNQQVJDIERCIGxvYWRlZC4iKTsgcmV0dXJuOyB9Y2F0Y2goZSl7IGxhc3RFcnIgPSBlOyB9IH0gY29uc29sZS53YXJuKCJbU1BBUkNdIEF1dG8tbG9hZCBmYWlsZWQ6IiwgY2FuZGlkYXRlcywgbGFzdEVycik7IGVsLnppcFN0YXR1cyAmJiAoZWwuemlwU3RhdHVzLnRleHRDb250ZW50ID0gIlNQQVJDIERCIG1pc3NpbmcgKFJvdG1vZF9MVEcuemlwKS4gQ2xpY2sgaGVyZSBvciB1c2UgTG9hZCBaSVAuIik7IGlmIChlbC56aXBTdGF0dXMgJiYgIWVsLnppcFN0YXR1cy5fX3ppcF9jbGljayl7IGVsLnppcFN0YXR1cy5zdHlsZS5jdXJzb3IgPSAicG9pbnRlciI7IGVsLnppcFN0YXR1cy5fX3ppcF9jbGljayA9IHRydWU7IGVsLnppcFN0YXR1cy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IGVsLnNwYXJjRmlsZSAmJiBlbC5zcGFyY0ZpbGUuY2xpY2soKSk7IH0gfSBhc3luYyBmdW5jdGlvbiByZWFkR2FsYXh5Q1NWKGdhbGF4eU5hbWUpeyBjb25zdCBtYXRjaCA9IHN0YXRlLmZpbGVzLmZpbmQoZiA9PiBmLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChgLyR7Z2FsYXh5TmFtZS50b0xvd2VyQ2FzZSgpfS5jc3ZgKSB8fCBmLm5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChgJHtnYWxheHlOYW1lLnRvTG93ZXJDYXNlKCl9LmNzdmApKTsgaWYgKCFtYXRjaCkgdGhyb3cgbmV3IEVycm9yKGBHYWxheHkgbm90IGZvdW5kIGluIFpJUDogJHtnYWxheHlOYW1lfWApOyBjb25zdCB0eHQgPSBhd2FpdCBtYXRjaC5lbnRyeS5hc3luYygic3RyaW5nIik7IHJldHVybiBwYXJzZVJvdG1vZFRleHQodHh0KTsgfSBhc3luYyBmdW5jdGlvbiBydW5TZWxlY3RlZEdhbGF4eSgpeyB0cnl7IGNvbnN0IG5hbWUgPSBlbC5nYWxheHlTZWxlY3QudmFsdWU7IHN0YXRlLmN1cnJlbnRHYWxheHkgPSBuYW1lOyBlbC5rcGlHYWxheHkgJiYgKGVsLmtwaUdhbGF4eS50ZXh0Q29udGVudCA9IG5hbWUpOyBjb25zdCByb3dzID0gYXdhaXQgcmVhZEdhbGF4eUNTVihuYW1lKTsgc3RhdGUuY3VycmVudFJvd3MgPSByb3dzOyBjb25zdCB7IHRhYmxlLCBSTVMgfSA9IGNvbXB1dGVQcmVkaWN0aW9uKG5hbWUsIHJvd3MpOyBzdGF0ZS5sYXN0Q1NWID0gdG9DU1YodGFibGUpOyBlbC5rcGlSTVMgJiYgKGVsLmtwaVJNUy50ZXh0Q29udGVudCA9IE51bWJlci5pc0Zpbml0ZShSTVMpID8gUk1TLnRvRml4ZWQoMikgOiAi4oCUIik7IHBsb3RHYWxheHkobmFtZSwgdGFibGUpOyBlbC5idG5DU1YuZGlzYWJsZWQgPSBmYWxzZTsgZWwuYnRuUE5HLmRpc2FibGVkID0gZmFsc2U7IH0gY2F0Y2ggKGVycil7IGNvbnNvbGUuZXJyb3IoZXJyKTsgYWxlcnQoYFJ1biBmYWlsZWQ6ICR7ZXJyLm1lc3NhZ2UgfHwgZXJyfWApOyB9IH0gYXN5bmMgZnVuY3Rpb24gcnVuR2xvYmFsUk1TKCl7IHRyeXsgZWwuZ2xvYmFsT3V0ICYmIChlbC5nbG9iYWxPdXQudGV4dENvbnRlbnQgPSAiQ29tcHV0aW5nIGdsb2JhbCBSTVMuLi4iKTsgY29uc3QgcG9pbnRzID0gW107IGZvciAoY29uc3QgbmFtZSBvZiBzdGF0ZS5nYWxheGllcyl7IGNvbnN0IHJvd3MgPSBhd2FpdCByZWFkR2FsYXh5Q1NWKG5hbWUpOyBjb25zdCB7IFJNUyB9ID0gY29tcHV0ZVByZWRpY3Rpb24obmFtZSwgcm93cyk7IHBvaW50cy5wdXNoKHsgbmFtZSwgUk1TIH0pOyB9IHBvaW50cy5zb3J0KChhLGIpID0+IChiLlJNU3x8MCkgLSAoYS5STVN8fDApKTsgcGxvdEdsb2JhbFJNUyhwb2ludHMpOyBjb25zdCBjc3YgPSBbIm5hbWUsUk1TX2ttX3MiXS5jb25jYXQocG9pbnRzLm1hcChwID0+IGAke3AubmFtZX0sJHtwLlJNU31gKSkuam9pbigiXG4iKTsgc3RhdGUubGFzdEdsb2JhbENTViA9IGNzdjsgZWwuYnRuR2xvYmFsQ1NWLmRpc2FibGVkID0gZmFsc2U7IGVsLmdsb2JhbE91dCAmJiAoZWwuZ2xvYmFsT3V0LnRleHRDb250ZW50ID0gYERvbmUuIFdvcnN0IFJNUzogJHtwb2ludHNbMF0ubmFtZX0gPSAke3BvaW50c1swXS5STVMudG9GaXhlZCgyKX0ga20vc2ApOyB9IGNhdGNoIChlcnIpeyBjb25zb2xlLmVycm9yKGVycik7IGFsZXJ0KGBHbG9iYWwgUk1TIGZhaWxlZDogJHtlcnIubWVzc2FnZSB8fCBlcnJ9YCk7IH0gfSBmdW5jdGlvbiBpc0R3YXJmTmFtZShuYW1lKXsgY29uc3QgcyA9IFN0cmluZyhuYW1lIHx8ICIiKS50b0xvd2VyQ2FzZSgpOyByZXR1cm4gcy5zdGFydHNXaXRoKCJjYW1iIikgfHwgcy5pbmNsdWRlcygiZHJhY28iKSB8fCBzLmluY2x1ZGVzKCJ1cnNhIikgfHwgcy5pbmNsdWRlcygic2V4dGFucyIpIHx8IHMuaW5jbHVkZXMoImNhcmluYSIpIHx8IHMuaW5jbHVkZXMoImZvcm5heCIpIHx8IHMuaW5jbHVkZXMoInNjdWxwdG9yIikgfHwgcy5pbmNsdWRlcygibGVvIik7IH0gYXN5bmMgZnVuY3Rpb24gcnVuRHdhcmZzKCl7IHRyeXsgZWwuZHdhcmZzT3V0ICYmIChlbC5kd2FyZnNPdXQudGV4dENvbnRlbnQgPSAiUnVubmluZyBkd2FyZiBzZXQuLi4iKTsgY29uc3QgZHdhcmZzID0gc3RhdGUuZ2FsYXhpZXMuZmlsdGVyKGlzRHdhcmZOYW1lKTsgY29uc3QgcG9pbnRzID0gW107IGZvciAoY29uc3QgbmFtZSBvZiBkd2FyZnMpeyBjb25zdCByb3dzID0gYXdhaXQgcmVhZEdhbGF4eUNTVihuYW1lKTsgY29uc3QgeyBSTVMgfSA9IGNvbXB1dGVQcmVkaWN0aW9uKG5hbWUsIHJvd3MpOyBwb2ludHMucHVzaCh7IG5hbWUsIFJNUyB9KTsgfSBwb2ludHMuc29ydCgoYSxiKSA9PiAoYi5STVN8fDApIC0gKGEuUk1TfHwwKSk7IGNvbnN0IHggPSBwb2ludHMubWFwKHAgPT4gcC5STVMpOyBjb25zdCB5ID0gcG9pbnRzLm1hcChwID0+IHAubmFtZSk7IFBsb3RseS5uZXdQbG90KGVsLnBsb3REd2FyZnMsIFt7IHgsIHksIHR5cGU6ImJhciIsIG9yaWVudGF0aW9uOiJoIiwgbmFtZToiUk1TIn1dLCB7IHRpdGxlOiAiRHdhcmZzIFJNUyIsIHhheGlzOiB7IHRpdGxlOiJSTVMgKGttL3MpIiB9LCBtYXJnaW46IHsgbDogMTQwLCByOiAyMCwgdDogNTAsIGI6IDQ1IH0sIHBhcGVyX2JnY29sb3I6ICJyZ2JhKDAsMCwwLDApIiwgcGxvdF9iZ2NvbG9yOiAicmdiYSgwLDAsMCwwKSIsIGZvbnQ6IHsgY29sb3I6ICJyZ2JhKDI0MCwyNDYsMjU1LC45MikiIH0sIH0sIHsgcmVzcG9uc2l2ZTp0cnVlLCBkaXNwbGF5bG9nbzpmYWxzZSB9KTsgc3RhdGUubGFzdER3YXJmc0NTViA9IFsibmFtZSxSTVNfa21fcyJdLmNvbmNhdChwb2ludHMubWFwKHAgPT4gYCR7cC5uYW1lfSwke3AuUk1TfWApKS5qb2luKCJcbiIpOyBlbC5idG5Ed2FyZnNDU1YuZGlzYWJsZWQgPSBmYWxzZTsgZWwuYnRuRHdhcmZzUE5HLmRpc2FibGVkID0gZmFsc2U7IGVsLmR3YXJmc091dCAmJiAoZWwuZHdhcmZzT3V0LnRleHRDb250ZW50ID0gYERvbmUuIE49JHtwb2ludHMubGVuZ3RofWApOyB9IGNhdGNoIChlcnIpeyBjb25zb2xlLmVycm9yKGVycik7IGFsZXJ0KGBEd2FyZnMgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVycn1gKTsgfSB9IGZ1bmN0aW9uIHdpcmUoKXsgaWYgKGVsLmJ0blJ1bkdhbGF4eSkgZWwuYnRuUnVuR2FsYXh5LmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0bkdsb2JhbFJNUykgZWwuYnRuR2xvYmFsUk1TLmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0bkNTVikgZWwuYnRuQ1NWLmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0blBORykgZWwuYnRuUE5HLmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0bkdsb2JhbENTVikgZWwuYnRuR2xvYmFsQ1NWLmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0bkR3YXJmc0NTVikgZWwuYnRuRHdhcmZzQ1NWLmRpc2FibGVkID0gdHJ1ZTsgaWYgKGVsLmJ0bkR3YXJmc1BORykgZWwuYnRuRHdhcmZzUE5HLmRpc2FibGVkID0gdHJ1ZTsgZWwuYnRuUnVuR2FsYXh5Py5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHJ1blNlbGVjdGVkR2FsYXh5KTsgZWwuYnRuR2xvYmFsUk1TPy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHJ1bkdsb2JhbFJNUyk7IGVsLmJ0bkNTVj8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7IGlmICghc3RhdGUubGFzdENTVikgcmV0dXJuOyBkb3dubG9hZFRleHQoYCR7c3RhdGUuY3VycmVudEdhbGF4eSB8fCAiZ2FsYXh5In1fcHJlZC5jc3ZgLCBzdGF0ZS5sYXN0Q1NWKTsgfSk7IGVsLmJ0blBORz8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7IGlmICghc3RhdGUubGFzdFBOR1RhcmdldCkgcmV0dXJuOyBkb3dubG9hZFBORyhzdGF0ZS5sYXN0UE5HVGFyZ2V0KTsgfSk7IGVsLmJ0bkdsb2JhbENTVj8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7IGlmICghc3RhdGUubGFzdEdsb2JhbENTVikgcmV0dXJuOyBkb3dubG9hZFRleHQoYGdsb2JhbF9ybXMuY3N2YCwgc3RhdGUubGFzdEdsb2JhbENTVik7IH0pOyBlbC5idG5SdW5Ed2FyZnM/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgcnVuRHdhcmZzKTsgZWwuYnRuRHdhcmZzQ1NWPy5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsICgpID0+IHsgaWYgKCFzdGF0ZS5sYXN0RHdhcmZzQ1NWKSByZXR1cm47IGRvd25sb2FkVGV4dCgiZHdhcmZzX3Jtcy5jc3YiLCBzdGF0ZS5sYXN0RHdhcmZzQ1NWKTsgfSk7IGVsLmJ0bkR3YXJmc1BORz8uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiBkb3dubG9hZFBORygicGxvdER3YXJmcyIpKTsgZWwuYnRuUmVzZXQ/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4gbG9jYXRpb24ucmVsb2FkKCkpOyBlbC5idG5SdW5Mb2N1c3M/LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKCkgPT4geyBlbC5sb2N1c3NPdXQgJiYgKGVsLmxvY3Vzc091dC50ZXh0Q29udGVudCA9ICJMb0N1U1MgbW9kdWxlIGlzIG5vdCBtb2RpZmllZCBieSB0aGlzIGNsZWFuIGJ1aWxkLiIpOyB9KTsgbG9hZFppcEZyb21SZXBvKCkuY2F0Y2goZXJyID0+IHsgY29uc29sZS5lcnJvcihlcnIpOyBlbC56aXBTdGF0dXMgJiYgKGVsLnppcFN0YXR1cy50ZXh0Q29udGVudCA9IGBFUlJPUiBsb2FkaW5nIFJvdG1vZF9MVEcuemlwOiAke2Vyci5tZXNzYWdlIHx8IGVycn1gKTsgYWxlcnQoYEVSUk9SOiBDb3VsZCBub3QgbG9hZCBSb3Rtb2RfTFRHLnppcC5cbk1ha2Ugc3VyZSB0aGUgWklQIGlzIGluIHRoZSByZXBvIHJvb3QuXG5cbiR7ZXJyLm1lc3NhZ2UgfHwgZXJyfWApOyB9KTsgfSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIiwgd2lyZSk7IGlmIChlbC5zcGFyY0ZpbGUgJiYgIWVsLnNwYXJjRmlsZS5fX3ppcF9jaGFuZ2UpeyBlbC5zcGFyY0ZpbGUuX196aXBfY2hhbmdlID0gdHJ1ZTsgZWwuc3BhcmNGaWxlLmFkZEV2ZW50TGlzdGVuZXIoImNoYW5nZSIsIGFzeW5jIChldikgPT4geyBjb25zdCBmID0gZXYudGFyZ2V0LmZpbGVzICYmIGV2LnRhcmdldC5maWxlc1swXTsgaWYgKCFmKSByZXR1cm47IHRyeXsgZWwuemlwU3RhdHVzICYmIChlbC56aXBTdGF0dXMudGV4dENvbnRlbnQgPSAiQ2FyZ2FuZG8gWklQIGxvY2FsLi4uIik7IGNvbnN0IGFiID0gYXdhaXQgZi5hcnJheUJ1ZmZlcigpOyBhd2FpdCBsb2FkWmlwRnJvbUFycmF5QnVmZmVyKGFiLCAibG9jYWwiKTsgfWNhdGNoKGVycil7IGNvbnNvbGUuZXJyb3IoIltTUEFSQ10gWklQIGxvY2FsIGVycm9yOiIsIGVycik7IGVsLnppcFN0YXR1cyAmJiAoZWwuemlwU3RhdHVzLnRleHRDb250ZW50ID0gIkVycm9yIGxleWVuZG8gZWwgWklQIGxvY2FsLiIpOyB9ZmluYWxseXsgdHJ5eyBlbC5zcGFyY0ZpbGUudmFsdWUgPSAiIjsgfWNhdGNoKGUpe30gfSB9KTsgfQ==";(new Function(atob(d)))();})();
</script>
</body>
</html>
